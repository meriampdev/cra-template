pipeline:
  # setup:
  #   image: node:latest
  #   commands: 
  #     - npm install
  #     - npm run build 

  build:
    image: docker/compose:1.23.2
    commands:
      - docker-compose build --force --no-cache
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock

  deploy:
    image: docker/compose:1.23.2
    commands:
      - docker-compose up -d --force-recreate
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock